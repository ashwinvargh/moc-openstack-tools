language: python
python:
  - "2.7"
sudo: required

branches:
  only:
    - master

cache:
  - pip

before_install:
    - wget https://github.com/openstack/keystone/archive/9.0.0.tar.gz -O /tmp/keystone.tar.gz
    - tar -xvf /tmp/keystone.tar.gz -C /tmp
    - cd /tmp/keystone-9.0.0
    - pip install -r requirements.txt
    - sudo python setup.py install


install:
    #- git clone https://github.com/openstack/keystone.git -b stable/mitaka
    #- cd keystone
    #- pip install -r requirements.txt
    #- pip install -r test-requirements.txt
    #- pip 
    - sudo apt-get install keystone
    - mkdir ~/.keystone
    - cp keystone.conf.sample ~/.keystone/keystone.conf
    - keystone-manage bootstrap --bootstrap-password traviskeystone
    - pip install flake8 pytest python-novaclient python-neutronclient python-cinderclient

script:
  - py.test
  #- py.test --ignore=keystone
  - flake8

